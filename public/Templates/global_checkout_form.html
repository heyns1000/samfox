<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåê VaultMesh‚Ñ¢ | Banimal Loop Checkout</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Base Styles - Consistent with FAA.zone theme, optimized for product page */
        :root {
            --text-color-light: #1d1d1f;
            --text-color-dark: #f5f5f7;
            --bg-color-light: #f5f5f7;
            --bg-color-dark: #1a1a1c;
            --card-bg-light: #ffffff;
            --card-bg-dark: #2a2a2e;
            --border-color-light: #e8e8ed;
            --border-color-dark: #3a3a3e;
            --primary-color: #0071e3; /* Apple Blue */
            --mindlift-color: #7B68EE; /* MediumPurple for MindLift theme */
            --mindlift-accent-color: #9370DB; /* Brighter purple */
            --muted-text-light: #6e6e73;
            --muted-text-dark: #a0a0a5;

            /* The specific green from your MindLift code for FCU/currency sections (used as the header green) */
            --fcu-color: #4CAF50; /* Green for currency */
            --fcu-accent-color: #66BB6A; /* Lighter green */

            /* SecureSign button colors (from your previous instruction, integrated into MindLift theme) */
            --secure-sign-purple: #8A2BE2;
            --secure-sign-blue: #4169E1;
            --secure-sign-purple-hover: #7b27cb;
            --secure-sign-blue-hover: #375ac7;

            /* New: Dynamic properties based on JS for header positioning */
            --announcement-bar-height: 0px; /* Default to 0, adjusted by JS if visible */
            --header-height: 80px; /* Example initial height, will be calculated by JS */

            /* New: Hyper Mode colors */
            --hyper-bg-color: #000033;
            --hyper-text-color: #FFCCFF;
            --hyper-card-bg: #110044;
            --hyper-border-color: #330066;
            --hyper-primary-color: #FF00FF; /* Magenta */
            --hyper-accent-color: #FF69B4; /* HotPink */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color-dark); /* Use MindLift's overall dark background */
            color: var(--text-color-dark); /* Default text color for dark theme */
            margin: 0;
            padding: 0;
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* NEW: Hyper Mode styles */
        body.hyper-mode {
            background-color: var(--hyper-bg-color);
            color: var(--hyper-text-color);
        }
        .hyper-mode .checkout-header {
            background-color: var(--hyper-primary-color);
            box-shadow: 0 10px 30px rgba(255, 0, 255, 0.4);
        }
        .hyper-mode .checkout-card {
            background-color: var(--hyper-card-bg);
            border-color: var(--hyper-border-color);
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }
        .hyper-mode .checkout-card h2,
        .hyper-mode .checkout-card h3 {
            color: var(--hyper-text-color);
        }
        .hyper-mode .checkout-card h3 i {
            color: var(--hyper-accent-color);
        }
        .hyper-mode .form-label {
            color: var(--hyper-text-color);
        }
        .hyper-mode .form-input, .hyper-mode .form-select {
            background-color: #000022;
            border-color: var(--hyper-border-color);
            color: var(--hyper-text-color);
        }
        .hyper-mode .form-input::placeholder {
            color: #AA44AA;
        }
        .hyper-mode .checkout-step-number {
            background-color: #330066;
            color: var(--hyper-text-color);
        }
        .hyper-mode .checkout-step-line {
            border-color: #330066;
        }
        .hyper-mode .checkout-step.active .checkout-step-number {
            background-color: var(--hyper-primary-color);
            color: white;
        }
        .hyper-mode .checkout-footer {
            background-color: var(--hyper-card-bg);
            border-top-color: var(--hyper-border-color);
        }


        .light-mode {
            background-color: var(--bg-color-light);
            color: var(--text-color-light);
        }

        .dark-mode {
            background-color: var(--bg-color-dark);
            color: var(--text-color-dark);
        }


        /* The .container class from your MindLift code will define max-width */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* NEW: Announcement Bar Styling */
        #announcement-bar {
            background-color: #4CAF50; /* Matches fcu-color */
            color: white;
            padding: 10px 20px;
            text-align: center;
            font-size: 0.9rem;
            position: relative;
            z-index: 1001; /* Higher than header sticky */
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #announcement-bar .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }
        #announcement-bar.hidden {
            display: none;
        }

        /* Header - Styled to perfectly match the MindLift banner from your screenshot */
        .checkout-header {
            background-color: var(--fcu-color); /* The solid green from the MindLift banner */
            color: white;
            min-height: 150px; /* Adjusted height based on visual comparison with screenshot */
            padding: 20px; /* Adjusted to allow internal flexbox to control layout */
            text-align: center; /* Fallback for content not managed by flex */
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.4); /* Green shadow */
            border-bottom: none;
            display: flex;
            flex-direction: column; /* Allow vertical centering of content inside header */
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center horizontally */
            position: sticky; /* Sticky header */
            top: var(--announcement-bar-height); /* Position header below announcement bar */
            z-index: 1000;
            /* backdrop-filter removed as per user request */
        }
        .checkout-header .header-content-wrapper {
            display: flex;
            flex-direction: column; /* Changed to column for text and sub-text */
            justify-content: center; /* Center vertically */
            align-items: center; /* Center horizontally */
            max-width: 1000px;
            width: 100%;
            padding: 0;
            text-align: center; /* Ensure text inside is centered */
        }
        /* Adjusted h1 for Banimal Loop */
        .checkout-header h1 {
            font-family: 'Inter', sans-serif;
            font-size: 3.8rem;
            font-weight: 800;
            line-height: 1.1;
            margin: 0;
            letter-spacing: -0.05em;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            color: white;
            word-break: break-word;
            -webkit-text-stroke: 1px rgba(255, 255, 255, 0.2);
        }
        /* New styling for the slogan/sub-headline */
        .checkout-header .slogan {
            font-family: 'Inter', sans-serif;
            font-size: 1.5rem; /* Larger than default p, similar to MindLift hero p */
            color: rgba(255, 255, 255, 0.9); /* Slightly muted white */
            margin-top: 10px; /* Space from h1 */
            line-height: 1.5;
            max-width: 800px; /* Constrain width for readability */
        }

        .checkout-header .back-link {
            font-family: 'Inter', sans-serif;
            color: white;
            font-weight: 600;
            text-decoration: none;
            transition: color 0.2s ease;
            white-space: nowrap;
            font-size: 1.1rem;
            margin-top: 20px; /* Space below slogan */
            display: block; /* Ensure it takes its own line below slogan */
        }
        .checkout-header .back-link:hover {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: underline;
        }

        /* Main Content Area - Dark theme, using MindLift card background for main wrapper */
        .main-content-area {
            flex-grow: 1;
            padding: 40px 20px;
            background-color: var(--bg-color-dark); /* Overall dark background from MindLift */
        }

        /* Individual Checkout Cards/Sections */
        .checkout-card {
            background-color: var(--card-bg-dark); /* Dark card background from MindLift code */
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3); /* Dark shadow from MindLift pricing card */
            border: 1px solid var(--border-color-dark); /* Dark border from MindLift code */
            padding: 30px;
            margin-bottom: 30px;
            color: var(--text-color-dark); /* Light text on dark card */
        }
        .checkout-card h2 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-color-dark); /* From MindLift section title */
            text-align: center;
            margin-bottom: 30px;
        }
        .checkout-card h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-color-dark); /* From MindLift feature card h3 */
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .checkout-card h3 i {
            color: var(--mindlift-accent-color); /* Icon color, using MindLift's purple accent */
            margin-right: 15px;
            font-size: 1.8rem;
        }

        /* Input field styling for dark theme */
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--muted-text-dark); /* Muted light text for labels */
        }
        .form-input, .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color-dark); /* Dark border for inputs */
            border-radius: 8px;
            background-color: #3a3a3e; /* Slightly darker input background, from MindLift inputs */
            color: var(--text-color-dark); /* Light text for input values */
            font-size: 1rem;
            box-sizing: border-box;
            transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
        }
        .form-input::placeholder {
            color: #718096; /* Muted placeholder text */
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-color); /* Apple Blue focus ring, from MindLift inputs */
            box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.2);
        }

        /* Checkout Buttons (SecureSign style within MindLift theme) */
        .checkout-action-button {
            display: block;
            width: 100%;
            height: 56px;
            font-size: 1.125rem;
            font-weight: 700;
            color: white;
            border: none;
            border-radius: 9999px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }

        .checkout-action-button.purple {
            background-color: var(--secure-sign-purple);
        }
        .checkout-action-button.purple:hover {
            background-color: var(--secure-sign-purple-hover);
            transform: translateY(-2px);
        }

        .checkout-action-button.blue {
            background-color: var(--secure-sign-blue);
        }
        .checkout-action-button.blue:hover {
            background-color: var(--secure-sign-blue-hover);
            transform: translateY(-2px);
        }

        /* Order Summary details */
        .order-summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-color-dark); /* Light text on dark card */
        }
        .order-summary-total {
            font-size: 1.3rem;
            font-weight: 700;
            border-top: 1px solid var(--border-color-dark); /* Dark border for total line */
            padding-top: 15px;
            margin-top: 15px;
            color: var(--text-color-dark);
        }

        /* Checkout steps specific styling for dark theme */
        .checkout-steps-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--muted-text-dark); /* Muted color for inactive steps */
            margin-bottom: 40px;
            padding: 0 10px;
        }
        .checkout-step {
            text-align: center;
            flex-shrink: 0;
        }
        .checkout-step-number {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            background-color: #4A5568; /* Darker gray for inactive circles */
            color: var(--muted-text-dark);
            font-weight: 700;
            margin: 0 auto 8px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .checkout-step-text {
            font-size: 0.9rem;
            font-weight: 500;
        }
        .checkout-step.active .checkout-step-number {
            background-color: var(--primary-color); /* Apple Blue for active step, from MindLift theme */
            color: white;
        }
        .checkout-step.active .checkout-step-text {
            color: var(--text-color-dark); /* Brighter text for active step */
        }
        .checkout-step-line {
            flex-grow: 1;
            border-top: 2px solid #4A5568; /* Darker gray line */
            margin: 0 10px;
        }

        /* Planet Pulse Text Styling (No Blur) */
        #planet-text {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-top: 40px;
            margin-bottom: 40px;
            color: var(--mindlift-color); /* Use MindLift purple accent */
            overflow: hidden; /* Hide overflow during animation */
            white-space: nowrap; /* Prevent text wrapping */
            animation: pulse-glow 3s infinite alternate; /* Apply animation */
            transition: all 0.5s ease-in-out;
            text-shadow: none; /* Explicitly remove text shadow that might cause blur */
        }

        @keyframes pulse-glow {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.05);
                opacity: 0.9;
            }
        }

        /* Styles for theme buttons in footer */
        .theme-controls button,
        .theme-controls select {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }

        /* Default (Light) Mode button styling */
        .theme-controls #theme-day-btn {
            background-color: var(--card-bg-light);
            color: var(--text-color-light);
            border-color: var(--border-color-light);
        }
        .light-mode .theme-controls #theme-day-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        .light-mode .theme-controls #theme-night-btn,
        .light-mode .theme-controls #theme-hyper-btn {
            background-color: var(--card-bg-light);
            color: var(--muted-text-light);
            border-color: var(--border-color-light);
        }

        /* Dark Mode button styling */
        .theme-controls #theme-night-btn {
            background-color: var(--card-bg-dark);
            color: var(--text-color-dark);
            border-color: var(--border-color-dark);
        }
        .dark-mode .theme-controls #theme-night-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        .dark-mode .theme-controls #theme-day-btn,
        .dark-mode .theme-controls #theme-hyper-btn {
            background-color: var(--card-bg-dark);
            color: var(--muted-text-dark);
            border-color: var(--border-color-dark);
        }

        /* Hyper Mode button styling */
        .theme-controls #theme-hyper-btn {
            background-color: var(--hyper-card-bg);
            color: var(--hyper-text-color);
            border-color: var(--hyper-border-color);
        }
        .hyper-mode .theme-controls #theme-hyper-btn.active {
            background-color: var(--hyper-primary-color);
            color: white;
            border-color: var(--hyper-primary-color);
        }
        .hyper-mode .theme-controls #theme-day-btn,
        .hyper-mode .theme-controls #theme-night-btn {
            background-color: var(--hyper-card-bg);
            color: var(--muted-text-dark); /* Use a muted version of hyper-text for non-active */
            border-color: var(--hyper-border-color);
        }

        /* Language Switcher */
        .theme-controls #languageSwitcher {
            background-color: var(--card-bg-dark);
            color: var(--text-color-dark);
            border-color: var(--border-color-dark);
            cursor: pointer;
        }
        .light-mode .theme-controls #languageSwitcher {
            background-color: var(--card-bg-light);
            color: var(--text-color-light);
            border-color: var(--border-color-light);
        }
        .hyper-mode .theme-controls #languageSwitcher {
            background-color: var(--hyper-card-bg);
            color: var(--hyper-text-color);
            border-color: var(--hyper-border-color);
        }

        /* Styling for generated text output to preserve whitespace */
        #generatedTextOutput {
            white-space: pre-wrap; /* Preserve whitespace and allow wrapping */
            word-break: break-word; /* Break long words */
        }

    </style>
</head>
<body lang="en">

    <!-- NEW: Announcement Bar -->
    <div id="announcement-bar" class="bg-fcu-color text-white text-center p-2 text-sm relative z-50">
        <div class="container flex justify-center items-center">
            <span data-lang-key="announcement-text"></span>
            <button class="close-btn text-white text-lg ml-4" aria-label="Close Announcement">&times;</button>
        </div>
    </div>

    <!-- Header Section (MindLift FCU Hero style) -->
    <header class="checkout-header" id="main-header">
        <div class="header-content-wrapper">
            <h1 class="text-white">üåê Banimal Loop‚Ñ¢</h1>
            <p class="slogan" data-lang-key="header-slogan"></p>
            <a href="#" class="back-link" data-lang-key="back-to-shop"></a>
        </div>
    </header>

    <main class="main-content-area">
        <div class="container max-w-3xl mx-auto">
            <div class="checkout-card">
                <h2 data-lang-key="complete-purchase"></h2>

                <!-- Checkout Steps/Progress -->
                <div class="checkout-steps-container">
                    <div class="checkout-step active">
                        <div class="checkout-step-number">1</div>
                        <span class="checkout-step-text" data-lang-key="shipping-step"></span>
                    </div>
                    <div class="checkout-step-line"></div>
                    <div class="checkout-step">
                        <div class="checkout-step-number">2</div>
                        <span class="checkout-step-text" data-lang-key="payment-step"></span>
                    </div>
                    <div class="checkout-step-line"></div>
                    <div class="checkout-step">
                        <div class="checkout-step-number">3</div>
                        <span class="checkout-step-text" data-lang-key="review-step"></span>
                    </div>
                </div>

                <!-- Shipping Information Section -->
                <section class="mb-8">
                    <h3 data-lang-key="shipping-info-heading"><i class="fas fa-shipping-fast"></i></h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="fullName" class="form-label" data-lang-key="full-name-label"></label>
                            <input type="text" id="fullName" class="form-input" data-lang-key="full-name-placeholder">
                        </div>
                        <div>
                            <label for="address" class="form-label" data-lang-key="address-label"></label>
                            <input type="text" id="address" class="form-input" data-lang-key="address-placeholder">
                        </div>
                        <div>
                            <label for="city" class="form-label" data-lang-key="city-label"></label>
                            <input type="text" id="city" class="form-input" data-lang-key="city-placeholder">
                        </div>
                        <div>
                            <label for="zip" class="form-label" data-lang-key="zip-code-label"></label>
                            <input type="text" id="zip" class="form-input" data-lang-key="zip-code-placeholder">
                        </div>
                    </div>
                </section>

                <!-- Payment Method Section -->
                <section class="mb-8">
                    <h3 data-lang-key="payment-method-heading"><i class="fas fa-credit-card"></i></h3>
                    <div class="space-y-4">
                        <div>
                            <label for="cardNumber" class="form-label" data-lang-key="card-number-label"></label>
                            <input type="text" id="cardNumber" class="form-input" placeholder="XXXX XXXX XXXX XXXX">
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div>
                                <label for="expMonth" class="form-label" data-lang-key="month-label"></label>
                                <input type="text" id="expMonth" class="form-input" placeholder="MM">
                            </div>
                            <div>
                                <label for="expYear" class="form-label" data-lang-key="year-label"></label>
                                <input type="text" id="expYear" class="form-input" placeholder="YY">
                            </div>
                            <div>
                                <label for="cvv" class="form-label" data-lang-key="cvv-label">CVV</label>
                                <input type="text" id="cvv" class="form-input" placeholder="123">
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Order Summary Section -->
                <section class="mb-8">
                    <h3 data-lang-key="order-summary-heading"><i class="fas fa-file-invoice-dollar"></i></h3>
                    <div class="space-y-3">
                        <div class="order-summary-item">
                            <span data-lang-key="product-item-1"></span>
                            <span>$XX.XX</span>
                        </div>
                        <div class="order-summary-item">
                            <span data-lang-key="product-item-2"></span>
                            <span>$YY.YY</span>
                        </div>
                        <div class="order-summary-item">
                            <span data-lang-key="shipping-cost"></span>
                            <span>$0.00</span>
                        </div>
                        <div class="order-summary-item order-summary-total">
                            <span data-lang-key="total-cost"></span>
                            <span>$ZZ.ZZ USD</span>
                        </div>
                    </div>
                </section>

                <!-- AI-Powered Help/FAQ Section -->
                <section class="checkout-card mt-8">
                    <h3 data-lang-key="ai-help-heading"><i class="fas fa-question-circle"></i></h3>
                    <p class="text-sm mb-4 text-center text-muted-text-dark" data-lang-key="ai-help-slogan"></p>
                    <div class="form-group">
                        <label for="faqPromptInput" class="form-label" data-lang-key="your-question-label"></label>
                        <textarea id="faqPromptInput" class="form-input" rows="4" data-lang-key="faq-placeholder"></textarea>
                    </div>
                    <button id="getFaqAnswerBtn" class="checkout-action-button purple mt-4" data-lang-key="get-answer-button"></button>
                    <div id="faqLoadingIndicator" class="hidden text-center mt-2 text-blue-400">
                        <i class="fas fa-spinner fa-spin mr-2"></i> <span data-lang-key="generating-answer-loading"></span>
                    </div>
                    <p id="faqAnswerOutput" class="result-text mt-4 whitespace-pre-wrap"></p>
                </section>

                <!-- Checkout Buttons (SecureSign style) -->
                <div class="space-y-4">
                    <button class="checkout-action-button purple" data-lang-key="finalize-button">
                        <i class="fas fa-check-circle ml-2"></i>
                    </button>
                    <button class="checkout-action-button blue" data-lang-key="review-order-button">
                        <i class="fas fa-search ml-2"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Planet Pulse Text -->
    <p id="planet-text" class="text-center text-xl font-bold mt-8 mb-8" data-lang-key="planet-pulse-text"></p>

    <!-- Global Banimal Footer -->
    <footer class="bg-gray-900 text-white py-8 px-6 md:px-20">
        <div class="banimal-footer-content text-center max-w-2xl mx-auto">
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-extrabold leading-tight text-white mb-2">
                <span data-lang-key="banimal-footer-heading"></span> <br>
                <span class="text-blue-400" data-lang-key="banimal-footer-slogan"></span>
            </h1>
            <p class="text-base md:text-lg text-gray-300 leading-relaxed mb-6" data-lang-key="banimal-footer-text"></p>
            <a href="global_brands.html" class="cta-button bg-blue-600 text-white font-semibold py-3 px-6 rounded-full inline-flex items-center justify-center hover:bg-blue-700 transition-colors duration-200" data-lang-key="explore-banimal-button">
                <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
        <p class="copyright text-sm text-gray-500 mt-8" data-lang-key="copyright-text-footer"></p>
        <p class="copyright text-sm text-gray-500" data-lang-key="powered-by-text"></p>

        <!-- Theme & Language Controls in Footer -->
        <div class="theme-controls flex items-center justify-center space-x-4 mt-4 flex-wrap gap-2">
            <button id="theme-day-btn" data-lang-key="light-mode-button"></button>
            <button id="theme-night-btn" data-lang-key="dark-mode-button"></button>
            <button id="theme-hyper-btn" data-lang-key="hyper-mode-button"></button>
            <select id="languageSwitcher" class="form-select">
                <!-- Options populated dynamically by JS -->
            </select>
        </div>
    </footer>

    <script type="module">
        // Object to hold all translations
        const translations = {
            en: {
                "lang-name": "English", // Added for language switcher display
                "announcement-text": "üöÄ Accelerate Your Workflow! Get 15% off Pro Grid for a limited time!",
                "header-slogan": "Buy one item, and we sponsor one! ‚ù§Ô∏è",
                "back-to-shop": "‚Üê Back to Shop",
                "complete-purchase": "Complete Your Purchase",
                "shipping-step": "Shipping",
                "payment-step": "Payment",
                "review-step": "Review",
                "shipping-info-heading": "Shipping Information",
                "full-name-label": "Full Name",
                "full-name-placeholder": "John Doe",
                "address-label": "Address",
                "address-placeholder": "123 Main Street",
                "city-label": "City",
                "city-placeholder": "Luxembourg City",
                "zip-code-label": "Zip Code",
                "zip-code-placeholder": "12345",
                "payment-method-heading": "Payment Method",
                "card-number-label": "Card Number",
                "month-label": "Month",
                "year-label": "Year",
                "cvv-label": "CVV",
                "order-summary-heading": "Order Summary",
                "product-item-1": "Product Item 1",
                "product-item-2": "Product Item 2",
                "shipping-cost": "Shipping",
                "total-cost": "Total",
                "ai-help-heading": "AI Help & FAQ Answers",
                "ai-help-slogan": "Ask your question about Banimal Loop‚Ñ¢ or FAA.zone, and our AI will answer.",
                "your-question-label": "Your Question:",
                "faq-placeholder": "e.g., What is the core protocol of Banimal Loop‚Ñ¢?",
                "get-answer-button": "Get Answer ‚ú®",
                "generating-answer-loading": "Generating answer...",
                "error-no-ai-answer": "Error: No answer from AI. Please try again later.",
                "reason": "Reason:",
                "error-ai-connection": "Error: Could not connect to language model. Check console for network issues.",
                "please-enter-question": "Please enter a question to get an answer.",
                "finalize-button": "Finalize & Confirm Order",
                "review-order-button": "Review Order Details",
                "planet-pulse-text": "fruchtbarer.planet.wandel",
                "banimal-footer-heading": "Banimal‚Ñ¢:",
                "banimal-footer-slogan": "üêëKind Creatures. Global Impact.",
                "banimal-footer-text": "Discover Banimal's world of thoughtful baby essentials & innovative lighting. For every purchase, we deliver the same item to a child in need, identified by the Baobab Security Network's data-driven insights.",
                "explore-banimal-button": "Explore Banimal's World",
                "copyright-text-footer": "&copy; üëü2025 Banimal‚Ñ¢. All rights reserved.",
                "powered-by-text": "A proud initiative of Fruitful‚Ñ¢ Treaty System‚Ñ¢",
                "light-mode-button": "Light Mode",
                "dark-mode-button": "Dark Mode",
                "hyper-mode-button": "Hyper Mode"
            },
            lb: { // Luxembourgish translations
                "lang-name": "L√´tzebuergesch", // Added for language switcher display
                "announcement-text": "üöÄ Beschleunegt √Ñre Workflow! Kritt 15% Rabatt op Pro Grid fir eng limit√©iert Z√§it!",
                "header-slogan": "Kaaft een Artikel a mir sponseren een! ‚ù§Ô∏è",
                "back-to-shop": "‚Üê Zr√©ck an de Buttek",
                "complete-purchase": "Komplett √Ñre Kaf",
                "shipping-step": "Versand",
                "payment-step": "Bezuelung",
                "review-step": "Iwwerpr√©iwen",
                "shipping-info-heading": "Versandinformatioun",
                "full-name-label": "Voll Numm",
                "full-name-placeholder": "Max Mustermann",
                "address-label": "Adress",
                "address-placeholder": "123 Haaptstrooss",
                "city-label": "Stad",
                "city-placeholder": "Stad L√´tzebuerg",
                "zip-code-label": "Postleetzuel",
                "zip-code-placeholder": "L-1234",
                "payment-method-heading": "Bezuelmethod",
                "card-number-label": "Kaartennummer",
                "month-label": "Mount",
                "year-label": "Joer",
                "cvv-label": "CVV",
                "order-summary-heading": "Bestellungsresum√©",
                "product-item-1": "Produkt Artikel 1",
                "product-item-2": "Produkt Artikel 2",
                "shipping-cost": "Versand",
                "total-cost": "Total",
                "ai-help-heading": "AI H√´llef & FAQ √Ñntwerten",
                "ai-help-slogan": "Stellt √Ñr Fro iwwer Banimal Loop‚Ñ¢ oder FAA.zone, an eis KI √§ntwert.",
                "your-question-label": "√Ñr Fro:",
                "faq-placeholder": "z.B. Wat ass de K√§rprotokoll vu Banimal Loop‚Ñ¢?",
                "get-answer-button": "Kritt √Ñntwert ‚ú®",
                "generating-answer-loading": "√Ñntwert g√´tt gener√©iert...",
                "error-no-ai-answer": "Feeler: Keng √Ñntwert vun der KI. Prob√©iert et w.e.g. m√©i sp√©it nach eng K√©ier.",
                "reason": "Grond:",
                "error-ai-connection": "Feeler: Konnt net mat der Sproochemodell verbannen. Kuckt d'Konsol fir Netzproblemer.",
                "please-enter-question": "Gitt w.e.g. eng Fro an, fir eng √Ñntwert ze kr√©ien.",
                "finalize-button": "Finalis√©ieren & Best√§tegen Bestellung",
                "review-order-button": "Bestellungsdetailer iwwerpr√©iwen",
                "planet-pulse-text": "fruchtbarer.planet.wandel",
                "banimal-footer-heading": "Banimal‚Ñ¢:",
                "banimal-footer-slogan": "üêëKind Creatures. Global Impact.",
                "banimal-footer-text": "Entdeckt d'Welt vu Banimal's nodenkleche Baby-Essentials an innovative Beliichtung. Fir all Kaf liwwere mir deeselwechten Artikel un e Kand an Nout, identifiz√©iert duerch d'Date-driven Abl√©ck vum Baobab S√©cherheetsnetz.",
                "explore-banimal-button": "Entdeckt d'Welt vu Banimal",
                "copyright-text-footer": "&copy; 2025 Banimal‚Ñ¢. All Rechter reserv√©iert.",
                "powered-by-text": "A proud initiative of Fruitful‚Ñ¢ Treaty System‚Ñ¢",
                "light-mode-button": "Liicht Modus",
                "dark-mode-button": "D√§ischter Modus",
                "hyper-mode-button": "Hyper Modus"
            }
            // Add more languages here if needed
        };

        // Function to set the current language and update all translatable elements
        function setLanguage(lang) {
            document.body.lang = lang; // Update the HTML body's lang attribute
            localStorage.setItem('selectedLanguage', lang); // Save user preference

            // Update all elements with data-lang-key
            document.querySelectorAll('[data-lang-key]').forEach(element => {
                const key = element.getAttribute('data-lang-key');
                if (translations[lang] && translations[lang][key] !== undefined) { // Check for undefined
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = translations[lang][key];
                    } else if (key === "finalize-button" || key === "review-order-button" || key === "explore-banimal-button" || key === "get-answer-button") {
                        // For buttons that contain text AND icons, handle text explicitly
                        const iconHtml = element.innerHTML.match(/<i class=".*"><\/i>/); // Extract icon HTML if present
                        if (iconHtml) {
                            element.innerHTML = translations[lang][key] + ' ' + iconHtml[0];
                        } else {
                            element.textContent = translations[lang][key];
                        }
                    } else if (key === "shipping-info-heading" || key === "payment-method-heading" || key === "order-summary-heading" || key === "ai-help-heading") {
                         // For headings that contain text AND icons, handle text explicitly
                        const iconHtml = element.innerHTML.match(/<i class=".*"><\/i>/); // Extract icon HTML if present
                        if (iconHtml) {
                            element.innerHTML = iconHtml[0] + ' ' + translations[lang][key];
                        } else {
                            element.textContent = translations[lang][key];
                        }
                    }
                    else {
                        element.textContent = translations[lang][key];
                    }
                } else {
                    console.warn(`Missing translation for key '${key}' in language '${lang}'`);
                    // Fallback to English if translation is missing
                    if (translations['en'] && translations['en'][key] !== undefined) {
                        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                            element.placeholder = translations['en'][key];
                        } else if (key === "finalize-button" || key === "review-order-button" || key === "explore-banimal-button" || key === "get-answer-button") {
                            const iconHtml = element.innerHTML.match(/<i class=".*"><\/i>/);
                            if (iconHtml) {
                                element.innerHTML = translations['en'][key] + ' ' + iconHtml[0];
                            } else {
                                element.textContent = translations['en'][key];
                            }
                        } else if (key === "shipping-info-heading" || key === "payment-method-heading" || key === "order-summary-heading" || key === "ai-help-heading") {
                            const iconHtml = element.innerHTML.match(/<i class=".*"><\/i>/);
                            if (iconHtml) {
                                element.innerHTML = iconHtml[0] + ' ' + translations['en'][key];
                            } else {
                                element.textContent = translations['en'][key];
                            }
                        }
                        else {
                            element.textContent = translations['en'][key];
                        }
                    }
                }
            });

            // Update AI response area message if it's an error/prompt message
            const faqAnswerOutput = document.getElementById('faqAnswerOutput');
            const faqPromptInput = document.getElementById('faqPromptInput');
            if (faqAnswerOutput && faqPromptInput) {
                // If the input is empty and the error message is displayed
                if (!faqPromptInput.value.trim() && faqAnswerOutput.textContent === translations['en']['please-enter-question']) {
                    faqAnswerOutput.textContent = translations[lang]['please-enter-question'];
                }
                // Check if the current displayed text is an English error message, then translate it
                if (faqAnswerOutput.textContent.startsWith(translations['en']['error-no-ai-answer'])) {
                    faqAnswerOutput.textContent = translations[lang]['error-no-ai-answer'];
                } else if (faqAnswerOutput.textContent.startsWith(translations['en']['error-ai-connection'])) {
                     faqAnswerOutput.textContent = translations[lang]['error-ai-connection'];
                }
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            const body = document.body;
            const mainHeader = document.getElementById('main-header');
            const announcementBar = document.getElementById('announcement-bar');

            // Function to update header top position based on announcement bar visibility
            const updateHeaderTop = () => {
                const announcementHeight = announcementBar && !announcementBar.classList.contains('hidden') ? announcementBar.offsetHeight : 0;
                document.documentElement.style.setProperty('--announcement-bar-height', `${announcementHeight}px`);
                document.documentElement.style.setProperty('--header-height', `${mainHeader.offsetHeight}px`);
            };

            // --- Announcement Bar Close Button ---
            if (announcementBar && announcementBar.querySelector('.close-btn')) {
                announcementBar.querySelector('.close-btn').addEventListener('click', () => {
                    announcementBar.classList.add('hidden');
                    updateHeaderTop();
                    localStorage.setItem('hideAnnouncementBar', 'true');
                });
            }

            // --- Theme Switching Logic ---
            const themeDayBtn = document.getElementById('theme-day-btn');
            const themeNightBtn = document.getElementById('theme-night-btn');
            const themeHyperBtn = document.getElementById('theme-hyper-btn');

            function setTheme(theme) {
                document.body.classList.remove('light-mode', 'dark-mode', 'hyper-mode');
                themeDayBtn?.classList.remove('active');
                themeNightBtn?.classList.remove('active');
                themeHyperBtn?.classList.remove('active');

                if (theme === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeNightBtn?.classList.add('active');
                } else if (theme === 'hyper') {
                    document.body.classList.add('hyper-mode');
                    themeHyperBtn?.classList.add('active');
                } else {
                    document.body.classList.add('light-mode');
                    themeDayBtn?.classList.add('active');
                }
                localStorage.setItem('themeMode', theme);
            }

            if (themeDayBtn && themeNightBtn && themeHyperBtn) {
                themeDayBtn.addEventListener('click', () => setTheme('day'));
                themeNightBtn.addEventListener('click', () => setTheme('dark'));
                themeHyperBtn.addEventListener('click', () => setTheme('hyper'));

                const savedTheme = localStorage.getItem('themeMode') || 'dark';
                setTheme(savedTheme);
            }

            // --- Language Switcher Logic ---
            const languageSwitcher = document.getElementById('languageSwitcher');
            if (languageSwitcher) {
                // Populate options dynamically from translations object
                for (const langCode in translations) {
                    const option = document.createElement('option');
                    option.value = langCode;
                    option.textContent = translations[langCode]["lang-name"] || langCode.toUpperCase(); // Use "lang-name" key
                    languageSwitcher.appendChild(option);
                }

                languageSwitcher.addEventListener('change', (e) => {
                    const selectedLang = e.target.value;
                    setLanguage(selectedLang);
                    console.log(`Language changed to: ${selectedLang}`);
                });

                // Set initial language from localStorage or default to English
                const initialLang = localStorage.getItem('selectedLanguage') || 'en';
                languageSwitcher.value = initialLang;
                setLanguage(initialLang); // Apply initial language on load
            }


            // --- On Load Initializations ---
            window.addEventListener('DOMContentLoaded', () => {
                if (announcementBar && mainHeader) {
                    if (localStorage.getItem('hideAnnouncementBar') === 'true') {
                        announcementBar.classList.add('hidden');
                        document.documentElement.style.setProperty('--announcement-bar-height', '0px');
                    } else {
                        announcementBar.classList.remove('hidden');
                        updateHeaderTop();
                    }
                    window.addEventListener('resize', updateHeaderTop);
                    window.addEventListener('load', updateHeaderTop);
                }
            });

            // --- Planet Pulse Text Logic ---
            const planetTextElement = document.getElementById('planet-text');
            const planetPhrases = [
                { text: "fruchtbarer.planet.wandel", lang: "de" }
            ];
            let currentPhraseIndex = 0;

            function updatePlanetText() {
                if (planetTextElement) {
                    planetTextElement.classList.remove('pulse-animation');
                    void planetTextElement.offsetWidth; // Trigger reflow
                    
                    currentPhraseIndex = (currentPhraseIndex + 1) % planetPhrases.length;
                    const nextPhrase = planetPhrases[currentPhraseIndex];
                    
                    planetTextElement.textContent = nextPhrase.text;
                    planetTextElement.lang = nextPhrase.lang;
                    
                    planetTextElement.classList.add('pulse-animation');
                }
            }
            if (planetTextElement) {
                setInterval(updatePlanetText, 3000);
                updatePlanetText();
            }


            // --- Gemini API Text Generation Logic (AI Help/FAQ) ---
            const getFaqAnswerBtn = document.getElementById('getFaqAnswerBtn');
            const faqPromptInput = document.getElementById('faqPromptInput');
            const faqAnswerOutput = document.getElementById('faqAnswerOutput');
            const faqLoadingIndicator = document.getElementById('faqLoadingIndicator');

            if (getFaqAnswerBtn && faqPromptInput && faqAnswerOutput && faqLoadingIndicator) {
                getFaqAnswerBtn.addEventListener('click', async () => {
                    const prompt = faqPromptInput.value.trim();
                    if (!prompt) {
                        faqAnswerOutput.textContent = translations[document.body.lang]['please-enter-question'];
                        faqAnswerOutput.style.color = "red";
                        return;
                    }

                    faqAnswerOutput.textContent = '';
                    faqAnswerOutput.style.color = "var(--text-color-dark)";
                    faqLoadingIndicator.classList.remove('hidden');
                    getFaqAnswerBtn.disabled = true;

                    try {
                        const fullPrompt = `The user has a question about Banimal Loop‚Ñ¢ or a similar product/promotion. Answer this question as precisely and concisely as possible. If the question is not related to Banimal Loop‚Ñ¢ or its promotion ("Buy one item, and we sponsor one!"), please state that you can only answer questions on these topics.

                        User's question: "${prompt}"

                        Information to consider:
                        - Banimal Loop‚Ñ¢ is a product/promotion where the user buys one item and the company sponsors one.
                        - The company is part of the FAA.ZONE ecosystem (but MindLift‚Ñ¢ details are not primarily relevant here).

                        Answer:`;

                        let chatHistory = [];
                        chatHistory.push({ role: "user", parts: [{ text: fullPrompt }] });
                        const payload = { contents: chatHistory };
                        const apiKey = ""; // Canvas will automatically provide this during runtime
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                        console.log("Attempting to call Gemini API with prompt:", fullPrompt);
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        console.log("Raw API Response Object:", response);
                        const result = await response.json();
                        console.log("Parsed API Result JSON:", result);

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            console.log("Extracted Generated Text:", text);
                            faqAnswerOutput.textContent = text;
                        } else {
                            faqAnswerOutput.textContent = translations[document.body.lang]['error-no-ai-answer'];
                            faqAnswerOutput.style.color = "red";
                            console.error("Gemini API response was unexpected or missing content:", result);
                            if (result.error && result.error.message) {
                                faqAnswerOutput.textContent += ` ${translations[document.body.lang]['reason']} ${result.error.message}`;
                            }
                        }

                    } catch (error) {
                        faqAnswerOutput.textContent = translations[document.body.lang]['error-ai-connection'];
                        faqAnswerOutput.style.color = "red";
                        console.error("Error calling Gemini API:", error);
                    } finally {
                        faqLoadingIndicator.classList.add('hidden');
                        getFaqAnswerBtn.disabled = false;
                    }
                });
            } else {
                console.warn("AI text generation elements (button, input, output, or loading indicator) not found in DOM. Please check IDs.");
            }
        });
    </script>
</body>
</html>
